!function(t){"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var e=function(){return(e=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};function n(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),s=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,o=i.length;a<o;a++,s++)r[s]=i[a];return r}var r="INUMBER",s="IVAR",i="IEXPR";function a(t,e){this.type=t,this.value=null!=e?e:0}function o(t){return new a("IOP1",t)}function u(t){return new a("IOP2",t)}function h(t){return new a("IOP3",t)}function p(t,e,n){var a,o,u,h,d,v,y=[];if(c(t))return f(t,n);for(var g=t.length,x=0;x<g;x++){var E=t[x],m=E.type;if(m===r||"IVARNAME"===m)y.push(E.value);else if("IOP2"===m)o=y.pop(),a=y.pop(),"and"===E.value?y.push(!!a&&!!p(o,e,n)):"or"===E.value?y.push(!!a||!!p(o,e,n)):"="===E.value?(h=e.binaryOps[E.value],y.push(h(a,p(o,e,n),n))):(h=e.binaryOps[E.value],y.push(h(f(a,n),f(o,n))));else if("IOP3"===m)u=y.pop(),o=y.pop(),a=y.pop(),"?"===E.value?y.push(p(a?o:u,e,n)):(h=e.ternaryOps[E.value],y.push(h(f(a,n),f(o,n),f(u,n))));else if(m===s)if(E.value in e.functions)y.push(e.functions[E.value]);else if(E.value in e.unaryOps&&e.parser.isOperatorEnabled(E.value))y.push(e.unaryOps[E.value]);else{var F=n[E.value];if(void 0===F)throw new Error("undefined variable: "+E.value);y.push(F)}else if("IOP1"===m)a=y.pop(),h=e.unaryOps[E.value],y.push(h(f(a,n)));else if("IFUNCALL"===m){for(v=E.value,d=[];v-- >0;)d.unshift(f(y.pop(),n));if(!(h=y.pop()).apply||!h.call)throw new Error(h+" is not a function");y.push(h.apply(void 0,d))}else if("IFUNDEF"===m)y.push(function(){for(var t=y.pop(),r=[],s=E.value;s-- >0;)r.unshift(y.pop());var i=y.pop(),a=function(){for(var s=Object.assign({},n),i=0,a=r.length;i<a;i++)s[r[i]]=arguments[i];return p(t,e,s)};return Object.defineProperty(a,"name",{value:i,writable:!1}),n[i]=a,a}());else if(m===i)y.push(l(E,e));else if("IEXPREVAL"===m)y.push(E);else if("IMEMBER"===m)a=y.pop(),y.push(a[E.value]);else if("IENDSTATEMENT"===m)y.pop();else{if("IARRAY"!==m)throw new Error("invalid Expression");for(v=E.value,d=[];v-- >0;)d.unshift(y.pop());y.push(d)}}if(y.length>1)throw new Error("invalid Expression (parity)");return 0===y[0]?0:f(y[0],n)}function l(t,e,n){return c(t)?t:{type:"IEXPREVAL",value:function(n){return p(t.value,e,n)}}}function c(t){return t&&"IEXPREVAL"===t.type}function f(t,e){return c(t)?t.value(e):t}function d(t,e){for(var n,a,o,u,h,p,l=[],c=0;c<t.length;c++){var f=t[c],y=f.type;if(y===r)"number"==typeof f.value&&f.value<0?l.push("("+f.value+")"):Array.isArray(f.value)?l.push("["+f.value.map(v).join(", ")+"]"):l.push(v(f.value));else if("IOP2"===y)a=l.pop(),n=l.pop(),u=f.value,e?"^"===u?l.push("Math.pow("+n+", "+a+")"):"and"===u?l.push("(!!"+n+" && !!"+a+")"):"or"===u?l.push("(!!"+n+" || !!"+a+")"):"||"===u?l.push("(function(a,b){ return Array.isArray(a) && Array.isArray(b) ? a.concat(b) : String(a) + String(b); }(("+n+"),("+a+")))"):"=="===u?l.push("("+n+" === "+a+")"):"!="===u?l.push("("+n+" !== "+a+")"):"["===u?l.push(n+"[("+a+") | 0]"):l.push("("+n+" "+u+" "+a+")"):"["===u?l.push(n+"["+a+"]"):l.push("("+n+" "+u+" "+a+")");else if("IOP3"===y){if(o=l.pop(),a=l.pop(),n=l.pop(),"?"!==(u=f.value))throw new Error("invalid Expression");l.push("("+n+" ? "+a+" : "+o+")")}else if(y===s||"IVARNAME"===y)l.push(f.value);else if("IOP1"===y)n=l.pop(),"-"===(u=f.value)||"+"===u?l.push("("+u+n+")"):e?"not"===u?l.push("(!"+n+")"):"!"===u?l.push("fac("+n+")"):l.push(u+"("+n+")"):"!"===u?l.push("("+n+"!)"):l.push("("+u+" "+n+")");else if("IFUNCALL"===y){for(p=f.value,h=[];p-- >0;)h.unshift(l.pop());u=l.pop(),l.push(u+"("+h.join(", ")+")")}else if("IFUNDEF"===y){for(a=l.pop(),p=f.value,h=[];p-- >0;)h.unshift(l.pop());n=l.pop(),e?l.push("("+n+" = function("+h.join(", ")+") { return "+a+" })"):l.push("("+n+"("+h.join(", ")+") = "+a+")")}else if("IMEMBER"===y)n=l.pop(),l.push(n+"."+f.value);else if("IARRAY"===y){for(p=f.value,h=[];p-- >0;)h.unshift(l.pop());l.push("["+h.join(", ")+"]")}else if(y===i)l.push("("+d(f.value,e)+")");else if("IENDSTATEMENT"!==y)throw new Error("invalid Expression")}return l.length>1&&(l=e?[l.join(",")]:[l.join(";")]),String(l[0])}function v(t){return"string"==typeof t?JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029"):t}function y(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return!1}function g(t,e,n){for(var r=!!(n=n||{}).withMembers,a=null,o=0;o<t.length;o++){var u=t[o];u.type===s||"IVARNAME"===u.type?r||y(e,u.value)?null!==a?(y(e,a)||e.push(a),a=u.value):a=u.value:e.push(u.value):"IMEMBER"===u.type&&r&&null!==a?a+="."+u.value:u.type===i?g(u.value,e,n):null!==a&&(y(e,a)||e.push(a),a=null)}null===a||y(e,a)||e.push(a)}function x(t,e){this.tokens=t,this.parser=e,this.unaryOps=e.unaryOps,this.binaryOps=e.binaryOps,this.ternaryOps=e.ternaryOps,this.functions=e.functions}a.prototype.toString=function(){switch(this.type){case r:case"IOP1":case"IOP2":case"IOP3":case s:case"IVARNAME":case"IENDSTATEMENT":return this.value;case"IFUNCALL":return"CALL "+this.value;case"IFUNDEF":return"DEF "+this.value;case"IARRAY":return"ARRAY "+this.value;case"IMEMBER":return"."+this.value;default:return"Invalid Instruction"}},x.prototype.simplify=function(t){return t=t||{},new x(function t(e,n,o,u,h){for(var p,l,c,f,d=[],v=[],y=0;y<e.length;y++){var g=e[y],x=g.type;if(x===r||"IVARNAME"===x)Array.isArray(g.value)?d.push.apply(d,t(g.value.map((function(t){return new a(r,t)})).concat(new a("IARRAY",g.value.length)),n,o,u,h)):d.push(g);else if(x===s&&h.hasOwnProperty(g.value))g=new a(r,h[g.value]),d.push(g);else if("IOP2"===x&&d.length>1)l=d.pop(),p=d.pop(),f=o[g.value],g=new a(r,f(p.value,l.value)),d.push(g);else if("IOP3"===x&&d.length>2)c=d.pop(),l=d.pop(),p=d.pop(),"?"===g.value?d.push(p.value?l.value:c.value):(f=u[g.value],g=new a(r,f(p.value,l.value,c.value)),d.push(g));else if("IOP1"===x&&d.length>0)p=d.pop(),f=n[g.value],g=new a(r,f(p.value)),d.push(g);else if(x===i){for(;d.length>0;)v.push(d.shift());v.push(new a(i,t(g.value,n,o,u,h)))}else if("IMEMBER"===x&&d.length>0)p=d.pop(),d.push(new a(r,p.value[g.value]));else{for(;d.length>0;)v.push(d.shift());v.push(g)}}for(;d.length>0;)v.push(d.shift());return v}(this.tokens,this.unaryOps,this.binaryOps,this.ternaryOps,t),this.parser)},x.prototype.substitute=function(t,e){return e instanceof x||(e=this.parser.parse(String(e))),new x(function t(e,n,r){for(var p=[],l=0;l<e.length;l++){var c=e[l],f=c.type;if(f===s&&c.value===n)for(var d=0;d<r.tokens.length;d++){var v,y=r.tokens[d];v="IOP1"===y.type?o(y.value):"IOP2"===y.type?u(y.value):"IOP3"===y.type?h(y.value):new a(y.type,y.value),p.push(v)}else f===i?p.push(new a(i,t(c.value,n,r))):p.push(c)}return p}(this.tokens,t,e),this.parser)},x.prototype.evaluate=function(t){return t=t||{},p(this.tokens,this,t)},x.prototype.toString=function(){return d(this.tokens,!1)},x.prototype.symbols=function(t){t=t||{};var e=[];return g(this.tokens,e,t),e},x.prototype.variables=function(t){t=t||{};var e=[];g(this.tokens,e,t);var n=this.functions;return e.filter((function(t){return!(t in n)}))},x.prototype.toJSFunction=function(t,e){var n=this,r=new Function(t,"with(this.functions) with (this.ternaryOps) with (this.binaryOps) with (this.unaryOps) { return "+d(this.simplify(e).tokens,!0)+"; }");return function(){return r.apply(n,arguments)}};var E="TOP",m="TPAREN";function F(t,e,n){this.type=t,this.value=e,this.index=n}function w(t,e){this.pos=0,this.current=null,this.unaryOps=t.unaryOps,this.binaryOps=t.binaryOps,this.ternaryOps=t.ternaryOps,this.consts=t.consts,this.expression=e,this.savedPosition=0,this.savedCurrent=null,this.options=t.options,this.parser=t}F.prototype.toString=function(){return this.type+": "+this.value},w.prototype.newToken=function(t,e,n){return new F(t,e,null!=n?n:this.pos)},w.prototype.save=function(){this.savedPosition=this.pos,this.savedCurrent=this.current},w.prototype.restore=function(){this.pos=this.savedPosition,this.current=this.savedCurrent},w.prototype.next=function(){return this.pos>=this.expression.length?this.newToken("TEOF","EOF"):this.isWhitespace()||this.isComment()?this.next():this.isRadixInteger()||this.isNumber()||this.isOperator()||this.isString()||this.isParen()||this.isBracket()||this.isComma()||this.isSemicolon()||this.isNamedOp()||this.isConst()||this.isName()?this.current:void this.parseError('Unknown character "'+this.expression.charAt(this.pos)+'"')},w.prototype.isString=function(){var t=!1,e=this.pos,n=this.expression.charAt(e);if("'"===n||'"'===n)for(var r=this.expression.indexOf(n,e+1);r>=0&&this.pos<this.expression.length;){if(this.pos=r+1,"\\"!==this.expression.charAt(r-1)){var s=this.expression.substring(e+1,r);this.current=this.newToken("TSTRING",this.unescape(s),e),t=!0;break}r=this.expression.indexOf(n,r+1)}return t},w.prototype.isParen=function(){var t=this.expression.charAt(this.pos);return("("===t||")"===t)&&(this.current=this.newToken(m,t),this.pos++,!0)},w.prototype.isBracket=function(){var t=this.expression.charAt(this.pos);return!("["!==t&&"]"!==t||!this.isOperatorEnabled("["))&&(this.current=this.newToken("TBRACKET",t),this.pos++,!0)},w.prototype.isComma=function(){return","===this.expression.charAt(this.pos)&&(this.current=this.newToken("TCOMMA",","),this.pos++,!0)},w.prototype.isSemicolon=function(){return";"===this.expression.charAt(this.pos)&&(this.current=this.newToken("TSEMICOLON",";"),this.pos++,!0)},w.prototype.isConst=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var n=this.expression.charAt(e);if(n.toUpperCase()===n.toLowerCase()&&(e===this.pos||"_"!==n&&"."!==n&&(n<"0"||n>"9")))break}if(e>t){var r=this.expression.substring(t,e);if(r in this.consts)return this.current=this.newToken("TNUMBER",this.consts[r]),this.pos+=r.length,!0}return!1},w.prototype.isNamedOp=function(){for(var t=this.pos,e=t;e<this.expression.length;e++){var n=this.expression.charAt(e);if(n.toUpperCase()===n.toLowerCase()&&(e===this.pos||"_"!==n&&(n<"0"||n>"9")))break}if(e>t){var r=this.expression.substring(t,e);if(this.isOperatorEnabled(r)&&(r in this.binaryOps||r in this.unaryOps||r in this.ternaryOps))return this.current=this.newToken(E,r),this.pos+=r.length,!0}return!1},w.prototype.isName=function(){for(var t=this.pos,e=t,n=!1;e<this.expression.length;e++){var r=this.expression.charAt(e);if(r.toUpperCase()===r.toLowerCase()){if(e===this.pos&&("$"===r||"_"===r)){"_"===r&&(n=!0);continue}if(e===this.pos||!n||"_"!==r&&(r<"0"||r>"9"))break}else n=!0}if(n){var s=this.expression.substring(t,e);return this.current=this.newToken("TNAME",s),this.pos+=s.length,!0}return!1},w.prototype.isWhitespace=function(){for(var t=!1,e=this.expression.charAt(this.pos);!(" "!==e&&"\t"!==e&&"\n"!==e&&"\r"!==e||(t=!0,this.pos++,this.pos>=this.expression.length));)e=this.expression.charAt(this.pos);return t};var T=/^[0-9a-f]{4}$/i;function A(t,e,n){this.parser=t,this.tokens=e,this.current=null,this.nextToken=null,this.next(),this.savedCurrent=null,this.savedNextToken=null,this.allowMemberAccess=!1!==n.allowMemberAccess}w.prototype.unescape=function(t){var e=t.indexOf("\\");if(e<0)return t;for(var n=t.substring(0,e);e>=0;){var r=t.charAt(++e);switch(r){case"'":n+="'";break;case'"':n+='"';break;case"\\":n+="\\";break;case"/":n+="/";break;case"b":n+="\b";break;case"f":n+="\f";break;case"n":n+="\n";break;case"r":n+="\r";break;case"t":n+="\t";break;case"u":var s=t.substring(e+1,e+5);T.test(s)||this.parseError("Illegal escape sequence: \\u"+s),n+=String.fromCharCode(parseInt(s,16)),e+=4;break;default:throw this.parseError('Illegal escape sequence: "\\'+r+'"')}++e;var i=t.indexOf("\\",e);n+=t.substring(e,i<0?t.length:i),e=i}return n},w.prototype.isComment=function(){return"/"===this.expression.charAt(this.pos)&&"*"===this.expression.charAt(this.pos+1)&&(this.pos=this.expression.indexOf("*/",this.pos)+2,1===this.pos&&(this.pos=this.expression.length),!0)},w.prototype.isRadixInteger=function(){var t,e,n=this.pos;if(n>=this.expression.length-2||"0"!==this.expression.charAt(n))return!1;if(++n,"x"===this.expression.charAt(n))t=16,e=/^[0-9a-f]$/i,++n;else{if("b"!==this.expression.charAt(n))return!1;t=2,e=/^[01]$/i,++n}for(var r=!1,s=n;n<this.expression.length;){var i=this.expression.charAt(n);if(!e.test(i))break;n++,r=!0}return r&&(this.current=this.newToken("TNUMBER",parseInt(this.expression.substring(s,n),t)),this.pos=n),r},w.prototype.isNumber=function(){for(var t,e=!1,n=this.pos,r=n,s=n,i=!1,a=!1;n<this.expression.length&&((t=this.expression.charAt(n))>="0"&&t<="9"||!i&&"."===t);)"."===t?i=!0:a=!0,n++,e=a;if(e&&(s=n),"e"===t||"E"===t){n++;for(var o=!0,u=!1;n<this.expression.length;){if(t=this.expression.charAt(n),!o||"+"!==t&&"-"!==t){if(!(t>="0"&&t<="9"))break;u=!0,o=!1}else o=!1;n++}u||(n=s)}return e?(this.current=this.newToken("TNUMBER",parseFloat(this.expression.substring(r,n))),this.pos=n):this.pos=s,e},w.prototype.isOperator=function(){var t=this.pos,e=this.expression.charAt(this.pos);if("+"===e||"-"===e||"*"===e||"/"===e||"%"===e||"^"===e||"?"===e||":"===e||"."===e)this.current=this.newToken(E,e);else if("∙"===e||"•"===e)this.current=this.newToken(E,"*");else if(">"===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(E,">="),this.pos++):this.current=this.newToken(E,">");else if("<"===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(E,"<="),this.pos++):this.current=this.newToken(E,"<");else if("|"===e){if("|"!==this.expression.charAt(this.pos+1))return!1;this.current=this.newToken(E,"||"),this.pos++}else if("="===e)"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(E,"=="),this.pos++):this.current=this.newToken(E,e);else{if("!"!==e)return!1;"="===this.expression.charAt(this.pos+1)?(this.current=this.newToken(E,"!="),this.pos++):this.current=this.newToken(E,e)}return this.pos++,!!this.isOperatorEnabled(this.current.value)||(this.pos=t,!1)},w.prototype.isOperatorEnabled=function(t){return this.parser.isOperatorEnabled(t)},w.prototype.getCoordinates=function(){var t,e=0,n=-1;do{e++,t=this.pos-n,n=this.expression.indexOf("\n",n+1)}while(n>=0&&n<this.pos);return{line:e,column:t}},w.prototype.parseError=function(t){var e=this.getCoordinates();throw new Error("parse error ["+e.line+":"+e.column+"]: "+t)},A.prototype.next=function(){return this.current=this.nextToken,this.nextToken=this.tokens.next()},A.prototype.tokenMatches=function(t,e){return void 0===e||(Array.isArray(e)?y(e,t.value):"function"==typeof e?e(t):t.value===e)},A.prototype.save=function(){this.savedCurrent=this.current,this.savedNextToken=this.nextToken,this.tokens.save()},A.prototype.restore=function(){this.tokens.restore(),this.current=this.savedCurrent,this.nextToken=this.savedNextToken},A.prototype.accept=function(t,e){return!(this.nextToken.type!==t||!this.tokenMatches(this.nextToken,e))&&(this.next(),!0)},A.prototype.expect=function(t,e){if(!this.accept(t,e)){var n=this.tokens.getCoordinates();throw new Error("parse error ["+n.line+":"+n.column+"]: Expected "+(e||t))}},A.prototype.parseAtom=function(t){var e=this.tokens.unaryOps;if(this.accept("TNAME")||this.accept(E,(function(t){return t.value in e})))t.push(new a(s,this.current.value));else if(this.accept("TNUMBER"))t.push(new a(r,this.current.value));else if(this.accept("TSTRING"))t.push(new a(r,this.current.value));else if(this.accept(m,"("))this.parseExpression(t),this.expect(m,")");else{if(!this.accept("TBRACKET","["))throw new Error("unexpected "+this.nextToken);if(this.accept("TBRACKET","]"))t.push(new a("IARRAY",0));else{var n=this.parseArrayList(t);t.push(new a("IARRAY",n))}}},A.prototype.parseExpression=function(t){var e=[];this.parseUntilEndStatement(t,e)||(this.parseVariableAssignmentExpression(e),this.parseUntilEndStatement(t,e)||this.pushExpression(t,e))},A.prototype.pushExpression=function(t,e){for(var n=0,r=e.length;n<r;n++)t.push(e[n])},A.prototype.parseUntilEndStatement=function(t,e){return!!this.accept("TSEMICOLON")&&(!this.nextToken||"TEOF"===this.nextToken.type||this.nextToken.type===m&&")"===this.nextToken.value||e.push(new a("IENDSTATEMENT")),"TEOF"!==this.nextToken.type&&this.parseExpression(e),t.push(new a(i,e)),!0)},A.prototype.parseArrayList=function(t){for(var e=0;!this.accept("TBRACKET","]");)for(this.parseExpression(t),++e;this.accept("TCOMMA");)this.parseExpression(t),++e;return e},A.prototype.parseVariableAssignmentExpression=function(t){for(this.parseConditionalExpression(t);this.accept(E,"=");){var e=t.pop(),n=[],r=t.length-1;if("IFUNCALL"!==e.type){if(e.type!==s&&"IMEMBER"!==e.type)throw new Error("expected variable for assignment");this.parseVariableAssignmentExpression(n),t.push(new a("IVARNAME",e.value)),t.push(new a(i,n)),t.push(u("="))}else{if(!this.tokens.isOperatorEnabled("()="))throw new Error("function definition is not permitted");for(var o=0,h=e.value+1;o<h;o++){var p=r-o;t[p].type===s&&(t[p]=new a("IVARNAME",t[p].value))}this.parseVariableAssignmentExpression(n),t.push(new a(i,n)),t.push(new a("IFUNDEF",e.value))}}},A.prototype.parseConditionalExpression=function(t){for(this.parseOrExpression(t);this.accept(E,"?");){var e=[],n=[];this.parseConditionalExpression(e),this.expect(E,":"),this.parseConditionalExpression(n),t.push(new a(i,e)),t.push(new a(i,n)),t.push(h("?"))}},A.prototype.parseOrExpression=function(t){for(this.parseAndExpression(t);this.accept(E,"or");){var e=[];this.parseAndExpression(e),t.push(new a(i,e)),t.push(u("or"))}},A.prototype.parseAndExpression=function(t){for(this.parseComparison(t);this.accept(E,"and");){var e=[];this.parseComparison(e),t.push(new a(i,e)),t.push(u("and"))}};var M=["==","!=","<","<=",">=",">","in"];A.prototype.parseComparison=function(t){for(this.parseAddSub(t);this.accept(E,M);){var e=this.current;this.parseAddSub(t),t.push(u(e.value))}};var O=["+","-","||"];A.prototype.parseAddSub=function(t){for(this.parseTerm(t);this.accept(E,O);){var e=this.current;this.parseTerm(t),t.push(u(e.value))}};var b=["*","/","%"];function k(t,e){return Number(t)+Number(e)}function _(t,e){return t-e}function I(t,e){return t*e}function C(t,e){return t/e}function N(t,e){return t%e}function R(t,e){return Array.isArray(t)&&Array.isArray(e)?t.concat(e):""+t+e}function V(t,e){return t===e}function S(t,e){return t!==e}function q(t,e){return t>e}function L(t,e){return t<e}function D(t,e){return t>=e}function P(t,e){return t<=e}function $(t,e){return Boolean(t&&e)}function B(t,e){return Boolean(t||e)}function U(t,e){return y(e,t)}function j(t){return(Math.exp(t)-Math.exp(-t))/2}function z(t){return(Math.exp(t)+Math.exp(-t))/2}function G(t){return t===1/0?1:t===-1/0?-1:(Math.exp(t)-Math.exp(-t))/(Math.exp(t)+Math.exp(-t))}function Y(t){return t===-1/0?t:Math.log(t+Math.sqrt(t*t+1))}function K(t){return Math.log(t+Math.sqrt(t*t-1))}function X(t){return Math.log((1+t)/(1-t))/2}function Z(t){return Math.log(t)*Math.LOG10E}function W(t){return-t}function J(t){return!t}function H(t){return t<0?Math.ceil(t):Math.floor(t)}function Q(t){return Math.random()*(t||1)}function tt(t){return nt(t+1)}A.prototype.parseTerm=function(t){for(this.parseFactor(t);this.accept(E,b);){var e=this.current;this.parseFactor(t),t.push(u(e.value))}},A.prototype.parseFactor=function(t){var e=this.tokens.unaryOps;if(this.save(),this.accept(E,(function(t){return t.value in e}))){if("-"!==this.current.value&&"+"!==this.current.value){if(this.nextToken.type===m&&"("===this.nextToken.value)return this.restore(),void this.parseExponential(t);if("TSEMICOLON"===this.nextToken.type||"TCOMMA"===this.nextToken.type||"TEOF"===this.nextToken.type||this.nextToken.type===m&&")"===this.nextToken.value)return this.restore(),void this.parseAtom(t)}var n=this.current;this.parseFactor(t),t.push(o(n.value))}else this.parseExponential(t)},A.prototype.parseExponential=function(t){for(this.parsePostfixExpression(t);this.accept(E,"^");)this.parseFactor(t),t.push(u("^"))},A.prototype.parsePostfixExpression=function(t){for(this.parseFunctionCall(t);this.accept(E,"!");)t.push(o("!"))},A.prototype.parseFunctionCall=function(t){var e=this.tokens.unaryOps;if(this.accept(E,(function(t){return t.value in e}))){var n=this.current;this.parseAtom(t),t.push(o(n.value))}else for(this.parseMemberExpression(t);this.accept(m,"(");)if(this.accept(m,")"))t.push(new a("IFUNCALL",0));else{var r=this.parseArgumentList(t);t.push(new a("IFUNCALL",r))}},A.prototype.parseArgumentList=function(t){for(var e=0;!this.accept(m,")");)for(this.parseExpression(t),++e;this.accept("TCOMMA");)this.parseExpression(t),++e;return e},A.prototype.parseMemberExpression=function(t){for(this.parseAtom(t);this.accept(E,".")||this.accept("TBRACKET","[");){var e=this.current;if("."===e.value){if(!this.allowMemberAccess)throw new Error('unexpected ".", member access is not permitted');this.expect("TNAME"),t.push(new a("IMEMBER",this.current.value))}else{if("["!==e.value)throw new Error("unexpected symbol: "+e.value);if(!this.tokens.isOperatorEnabled("["))throw new Error('unexpected "[]", arrays are disabled');this.parseExpression(t),this.expect("TBRACKET","]"),t.push(u("["))}}};var et=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function nt(t){var e,n;if(function(t){return isFinite(t)&&t===Math.round(t)}(t)){if(t<=0)return isFinite(t)?1/0:NaN;if(t>171)return 1/0;for(var r=t-2,s=t-1;r>1;)s*=r,r--;return 0===s&&(s=1),s}if(t<.5)return Math.PI/(Math.sin(Math.PI*t)*nt(1-t));if(t>=171.35)return 1/0;if(t>85){var i=t*t,a=i*t,o=a*t,u=o*t;return Math.sqrt(2*Math.PI/t)*Math.pow(t/Math.E,t)*(1+1/(12*t)+1/(288*i)-139/(51840*a)-571/(2488320*o)+163879/(209018880*u)+5246819/(75246796800*u*t))}--t,n=et[0];for(var h=1;h<et.length;++h)n+=et[h]/(t+h);return e=t+4.7421875+.5,Math.sqrt(2*Math.PI)*Math.pow(e,t+.5)*Math.exp(-e)*n}function rt(t){return Array.isArray(t)?t.length:String(t).length}function st(){for(var t=0,e=0,n=0;n<arguments.length;n++){var r,s=Math.abs(arguments[n]);e<s?(t=t*(r=e/s)*r+1,e=s):t+=s>0?(r=s/e)*r:s}return e===1/0?1/0:e*Math.sqrt(t)}function it(t,e,n){return t?e:n}function at(t,e){return void 0===e||0==+e?Math.round(t):(t=+t,e=-+e,isNaN(t)||"number"!=typeof e||e%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math.round(+(t[0]+"e"+(t[1]?+t[1]-e:-e)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+e:e))))}function ot(t,e,n){return n&&(n[t]=e),e}function ut(t,e){return t[0|e]}function ht(t){return 1===arguments.length&&Array.isArray(t)?Math.max.apply(Math,t):Math.max.apply(Math,arguments)}function pt(t){return 1===arguments.length&&Array.isArray(t)?Math.min.apply(Math,t):Math.min.apply(Math,arguments)}function lt(t,e){if("function"!=typeof t)throw new Error("First argument to map is not a function");if(!Array.isArray(e))throw new Error("Second argument to map is not an array");return e.map((function(e,n){return t(e,n)}))}function ct(t,e,n){if("function"!=typeof t)throw new Error("First argument to fold is not a function");if(!Array.isArray(n))throw new Error("Second argument to fold is not an array");return n.reduce((function(e,n,r){return t(e,n,r)}),e)}function ft(t,e){if("function"!=typeof t)throw new Error("First argument to filter is not a function");if(!Array.isArray(e))throw new Error("Second argument to filter is not an array");return e.filter((function(e,n){return t(e,n)}))}function dt(t,e){if(!Array.isArray(e)&&"string"!=typeof e)throw new Error("Second argument to indexOf is not a string or array");return e.indexOf(t)}function vt(t,e){if(!Array.isArray(e))throw new Error("Second argument to join is not an array");return e.join(t)}function yt(t){return(t>0)-(t<0)||+t}function gt(t){return t<0?-Math.pow(-t,1/3):Math.pow(t,1/3)}function xt(t){return Math.exp(t)-1}function Et(t){return Math.log(1+t)}function mt(t){return Math.log(t)/Math.LN2}function Ft(t){this.options=t||{},this.unaryOps={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,sinh:Math.sinh||j,cosh:Math.cosh||z,tanh:Math.tanh||G,asinh:Math.asinh||Y,acosh:Math.acosh||K,atanh:Math.atanh||X,sqrt:Math.sqrt,cbrt:Math.cbrt||gt,log:Math.log,log2:Math.log2||mt,ln:Math.log,lg:Math.log10||Z,log10:Math.log10||Z,expm1:Math.expm1||xt,log1p:Math.log1p||Et,abs:Math.abs,ceil:Math.ceil,floor:Math.floor,round:Math.round,trunc:Math.trunc||H,"-":W,"+":Number,exp:Math.exp,not:J,length:rt,"!":tt,sign:Math.sign||yt},this.binaryOps={"+":k,"-":_,"*":I,"/":C,"%":N,"^":Math.pow,"||":R,"==":V,"!=":S,">":q,"<":L,">=":D,"<=":P,and:$,or:B,in:U,"=":ot,"[":ut},this.ternaryOps={"?":it},this.functions={random:Q,fac:tt,min:pt,max:ht,hypot:Math.hypot||st,pyt:Math.hypot||st,pow:Math.pow,atan2:Math.atan2,if:it,gamma:nt,roundTo:at,map:lt,fold:ct,filter:ft,indexOf:dt,join:vt},this.consts={E:Math.E,PI:Math.PI,true:!0,false:!1}}Ft.prototype.parse=function(t){var e=[],n=new A(this,new w(this,t),{allowMemberAccess:this.options.allowMemberAccess});return n.parseExpression(e),n.expect("TEOF","EOF"),new x(e,this)},Ft.prototype.evaluate=function(t,e){return this.parse(t).evaluate(e)};var wt=new Ft;Ft.parse=function(t){return wt.parse(t)},Ft.evaluate=function(t,e){return wt.parse(t).evaluate(e)};var Tt={"+":"add","-":"subtract","*":"multiply","/":"divide","%":"remainder","^":"power","!":"factorial","<":"comparison",">":"comparison","<=":"comparison",">=":"comparison","==":"comparison","!=":"comparison","||":"concatenate",and:"logical",or:"logical",not:"logical","?":"conditional",":":"conditional","=":"assignment","[":"array","()=":"fndef"};function At(t){return t.name?t.name:t.constructor.name}Ft.prototype.isOperatorEnabled=function(t){var e=function(t){return Tt.hasOwnProperty(t)?Tt[t]:t}(t),n=this.options.operators||{};return!(e in n)||!!n[e]};var Mt,Ot=function(){function t(t){this.message="",this.condition_expr=null,this.validator=t}return Object.defineProperty(t.prototype,"condition",{set:function(t){if(t){var e=new Ft;this.condition_expr=e.parse(t)}else this.condition_expr=null},enumerable:!1,configurable:!0}),t}(),bt=function(){function t(t,e){this.fields=t,this.validator_info=e,this.validations=[]}return t.prototype.addValidation=function(t){this.validations.push(new Ot(t))},t.prototype.addMessage=function(t){this.validations.length>0&&(this.validations[this.validations.length-1].message=t)},t.prototype.addCondition=function(t){this.validations.length>0&&(this.validations[this.validations.length-1].condition=t)},t.prototype.validate=function(t){for(var e={},n=0,r=this.validations;n<r.length;n++){var s=r[n];if(null!==s.condition_expr)if(!s.condition_expr.evaluate(t))continue;for(var i=0,a=this.fields;i<a.length;i++){var o=a[i];s.validator.validate(o,t)||e[o]||(e[o]={validation:At(s.validator),message:this.getMessage(s,o,t)})}}return e},t.prototype.getMessage=function(t,e,r){var s="";s=t.message?t.message:this.validator_info.getMessageTemplate(t.validator);var i=n(["field"],Object.keys(t.validator)),a=n([e],Object.values(t.validator));return(new(Function.bind.apply(Function,n([void 0],i,["return `"+s+"`;"])))).apply(void 0,a)},t.prototype.hasValidations=function(){return this.validations.length>0},t}(),kt=function(){function t(t){this.field_v=t}return t.prototype.addValidation=function(t){this.field_v.addValidation(t)},t.prototype.validate=function(t){return this.field_v.validate(t)},t.prototype.message=function(t){return this.field_v.addMessage(t),this},t.prototype.onlyWhen=function(t){return this.field_v.addCondition(t),this},t}(),_t=function(){function t(){this.message="${field} is required"}return t.prototype.validate=function(t,e){if(e[t]){if(String(e[t]).length>0)return!0}else if(0===e[t]||!1===e[t])return!0;return!1},t}(),It=function(){function t(t){this.max_length=t,this.message="${field} exceeded max length ${max_length}"}return t.prototype.validate=function(t,e){return void 0===e[t]||!(String(e[t]).length>this.max_length)},t}(),Ct=function(){function t(t){this.min_length=t,this.message="${field} input length should be at least ${min_length}"}return t.prototype.validate=function(t,e){return void 0===e[t]||!(String(e[t]).length<this.min_length)},t}(),Nt={"<":{name:"LessThan",message:"${field} should be less than ${test_value}",fn:function(t,e){return t<e}},"<=":{name:"LessThanOrEqualTo",message:"${field} should be less than or equal to ${test_value}",fn:function(t,e){return t<=e}},">":{name:"GreaterThan",message:"${field} should be greater than ${test_value}",fn:function(t,e){return t>e}},">=":{name:"GreaterThanOrEqualTo",message:"${field} should be greater than or equal to ${test_value}",fn:function(t,e){return t>=e}},"=":{name:"EqualTo",message:"${field} should be equal to ${test_value}",fn:function(t,e){return t===e}},"!=":{name:"NotEqualTo",message:"${field} should not be equal to ${test_value}",fn:function(t,e){return t!==e}}};!function(t){t[t.Value=0]="Value",t[t.Field=1]="Field"}(Mt||(Mt={}));var Rt=function(){function t(t,e){if(this.comparison=t,this.options=e,this.message="",this.test_value=0,this.test_against=Mt.Value,this.name="",!Object.keys(Nt).includes(t))throw Error("unsupported comparison operator "+t);if(this.name=Nt[t].name,this.message=Nt[t].message,void 0!==e.test_value)this.test_against=Mt.Value,this.test_value=e.test_value;else{if(void 0===e.test_field)throw Error("Provide one of test_value or test_field in the options");this.test_against=Mt.Field,this.test_value=e.test_field}}return t.prototype.validate=function(t,e){var n=this.getOtherValue(e);return"="==this.comparison||"!="==this.comparison?this.doEqualTest(e[t],n):this.doComparison(Number(e[t]),Number(n))},t.prototype.getOtherValue=function(t){if(this.test_against==Mt.Field){if(void 0===this.options.test_field)throw Error("The test_field is not provided");return t[this.options.test_field]}if(void 0===this.options.test_value)throw Error("The test_value is not provided");return this.options.test_value},t.prototype.doComparison=function(t,e){return Nt[this.comparison].fn(t,e)},t.prototype.doEqualTest=function(t,e){return Nt[this.comparison].fn(t,e)},t}();var Vt=function(){function t(){this.validator_makers={},this.all_validators={}}return t.prototype.addValidator=function(t,e){if("string"==typeof t)this.validator_makers[t]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.addValidation(e.apply(void 0,t)),this};else for(var n=0,r=t;n<r.length;n++){var s=r[n];this.addValidator(s,e)}return this},t.prototype.updateMessages=function(t){for(var e in t)this.all_validators[e]?this.all_validators[e].message=t[e]:this.all_validators[e]={message:t[e]}},t.prototype.field=function(t){var e=new kt(new bt([t],this));return Object.assign(e,this.validator_makers),e},t.prototype.fields=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=new kt(new bt(t,this));return Object.assign(n,this.validator_makers),n},t.prototype.validate=function(t,e){return this.validateByRules(t,e)},t.prototype.validateByRules=function(t,n){for(var r={},s=0,i=t;s<i.length;s++){var a=i[s].validate(n);r=e(e({},r),a)}return{has_errors:Object.keys(r).length>0,error_map:r}},t.prototype.validateFields=function(t,e){var n=function(t,e){for(var n=[],r=0,s=t;r<s.length;r++){for(var i=s[r],a=new bt([i.name],e),o=0,u=i.validations;o<u.length;o++){var h=u[o],p=null;switch(h._vtype){case"Required":p=new _t;break;case"MaxLength":p=new It(+h.size);break;case"MinLength":p=new Ct(+h.size);break;case"LessThan":p=new Rt("<",{test_value:+h.num});break;case"GreaterThan":p=new Rt(">",{test_value:+h.num})}p&&(a.addValidation(p),h.message&&a.addMessage(h.message),h.condition&&a.addCondition(h.condition))}a.hasValidations()&&n.push(a)}return n}(t,this);return n.length<=0?{has_errors:!1}:this.validateByRules(n,e)},t.prototype.getMessageTemplate=function(t){var e="Error! ",n=At(t);return this.all_validators[n]&&this.all_validators[n].message?e=this.all_validators[n].message:t.message&&(e=t.message),e},t}(),St=function(){function t(t){void 0===t&&(t=!0),this.allow_space=t,this.message="${field} can contain only English alphabetic characters"}return t.prototype.validate=function(t,e){var n=/^[A-Za-z]+$/i;return this.allow_space&&(n=/^[A-Za-z\s]+$/i),n.test(String(e[t]))},t}(),qt=function(){function t(t){void 0===t&&(t=!0),this.allow_space=t,this.message="${field} can contain only alpha-numeric characters"}return t.prototype.validate=function(t,e){var n=/^[A-Za-z0-9]+$/i;return this.allow_space&&(n=/^[A-Za-z0-9\s]+$/i),n.test(String(e[t]))},t}(),Lt=function(){function t(){this.message="Please provide a valid email address"}return t.prototype.validate=function(t,e){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(String(e[t]))},t}(),Dt=function(){function t(t){this.max_count=t,this.message="${field} selections exceeds max limit ${max_count}"}return t.prototype.validate=function(t,e){return void 0===e[t]||!(e[t].length>this.max_count)},t}(),Pt=function(){function t(t){this.min_count=t,this.message="For ${field}, select at least ${min_count} options"}return t.prototype.validate=function(t,e){return void 0===e[t]||!(e[t].length<this.min_count)},t}(),$t=function(){function t(){this.message="${field} should be selected"}return t.prototype.validate=function(t,e){return!!e[t]},t}(),Bt=function(){function t(t){this.extensions_str=t,this.message="Valid file extensions are: ${extensions_str}",this.valid_extensions=[],this.valid_extensions=this.extensions_str.split(",").map((function(t){return t.trim()}))}return t.prototype.validate=function(t,e){if(e[t]){var n=e[t].split(".").pop();if(!this.valid_extensions.includes(n))return!1}return!0},t}();t.makeBoel=function(){return(t=new Vt).addValidator(["isRequired","areRequired","required"],(function(){return new _t})).addValidator(["maxLength","checkMaxLength"],(function(t){return new It(t)})).addValidator(["minLength","checkMinLength"],(function(t){return new Ct(t)})).addValidator(["isAlphabetic","areAlphabetic"],(function(t){return void 0===t&&(t=!0),new St(t)})).addValidator(["isAlphaNumeric","areAlphaNumeric"],(function(t){return void 0===t&&(t=!0),new qt(t)})).addValidator(["isEmail","areEmails"],(function(){return new Lt})).addValidator(["lessThan","isLessThan","areLessThan"],(function(t){return new Rt("<",{test_value:t})})).addValidator(["lessThanOrEqualTo","isLessThanOrEqualTo","areLessThanOrEqualTo"],(function(t){return new Rt("<=",{test_value:t})})).addValidator(["greaterThan","isGreaterThan","areGreaterThan"],(function(t){return new Rt(">",{test_value:t})})).addValidator(["greaterThanOrEqualTo","isGreaterThanOrEqualTo","areGreaterThanOrEqualTo"],(function(t){return new Rt(">=",{test_value:t})})).addValidator(["equalsTo","isEqualTo","areEqualTo"],(function(t){return new Rt("=",{test_value:t})})).addValidator(["notEqualTo","isNotEqualTo","areNotEqualTo"],(function(t){return new Rt("!=",{test_value:t})})).addValidator(["lessThanField","isLessThanField","areLessThanField"],(function(t){return new Rt("<",{test_field:t})})).addValidator(["lessThanOrEqualToField","isLessThanOrEqualToField","areLessThanOrEqualToField"],(function(t){return new Rt("<=",{test_field:t})})).addValidator(["greaterThanField","isGreaterThanField","areGreaterThanField"],(function(t){return new Rt(">",{test_field:t})})).addValidator(["greaterThanOrEqualToField","isGreaterThanOrEqualToField","areGreaterThanOrEqualToField"],(function(t){return new Rt(">=",{test_field:t})})).addValidator(["equalsToField","isEqualToField","areEqualToField"],(function(t){return new Rt("=",{test_field:t})})).addValidator(["notEqualsToField","isNotEqualToField","areNotEqualToField"],(function(t){return new Rt("!=",{test_field:t})})).addValidator(["maxSelections","hasMaxSelections"],(function(t){return new Dt(t)})).addValidator(["minSelections","hasMinSelections"],(function(t){return new Pt(t)})).addValidator(["shouldBeSelected","isSelected","selected"],(function(){return new $t})).addValidator(["hasExtension","hasFileExtension"],(function(t){return new Bt(t)})),t;var t}}(this.boel=this.boel||{});